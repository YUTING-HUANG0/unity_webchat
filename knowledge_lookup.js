
// 1. çŸ¥è­˜åº«å®šç¾© (Knowledge Base Definition)
//    - é€™æ˜¯æ‚¨çš„ QA æ•¸æ“šï¼ŒåŒ…å«ç”¨æ–¼åŒ¹é…çš„é—œéµå­—ã€‚
// ----------------------------------------------------

const KNOWLEDGE_BASE = [
    {
        "ä¸»é¡Œ": "ç”Ÿæˆå¼AI",
        "å•é¡Œ": "ä»€éº¼æ˜¯ç”Ÿæˆå¼AIï¼ˆGenerative AIï¼‰ï¼Ÿ",
        "ç­”æ¡ˆ": "ç”Ÿæˆå¼AIæ˜¯ä¸€ç¨®äººå·¥æ™ºæ…§ï¼Œå®ƒèƒ½å¤ æ ¹æ“šå­¸ç¿’åˆ°çš„æ•¸æ“šæ¨¡å¼ï¼Œå‰µé€ å‡ºå…¨æ–°çš„ã€åŽŸå‰µçš„å…§å®¹ï¼Œå¦‚æ–‡æœ¬ã€åœ–åƒã€éŸ³è¨Šã€è¦–è¨Šå’Œç¨‹å¼ç¢¼ã€‚",
        "keywords": ["ç”Ÿæˆå¼AI", "Generative AI", "å®šç¾©", "å‰µé€ å…§å®¹"]
    },
    {
        "ä¸»é¡Œ": "ç”Ÿæˆå¼AI",
        "å•é¡Œ": "ç”Ÿæˆå¼AIçš„æ ¸å¿ƒæŠ€è¡“æ˜¯ä»€éº¼ï¼Ÿ",
        "ç­”æ¡ˆ": "ç›®å‰ç”Ÿæˆå¼AIçš„æ ¸å¿ƒæŠ€è¡“ä¸»è¦åŸºæ–¼å¤§åž‹èªžè¨€æ¨¡åž‹ï¼ˆLLMsï¼‰å’Œæ“´æ•£æ¨¡åž‹ï¼ˆDiffusion Modelsï¼‰ï¼Œå®ƒå€‘ä½¿ç”¨è®Šå½¢å™¨ï¼ˆTransformerï¼‰æž¶æ§‹ä¾†è™•ç†åºåˆ—æ•¸æ“šä¸¦ç”Ÿæˆå…§å®¹ã€‚",
        "keywords": ["æ ¸å¿ƒæŠ€è¡“", "LLMs", "å¤§åž‹èªžè¨€æ¨¡åž‹", "æ“´æ•£æ¨¡åž‹", "Diffusion Models"]
    },
    {
        "ä¸»é¡Œ": "ç§‘æŠ€æŽ¥å—æ¨¡åž‹ (TAM)",
        "å•é¡Œ": "TAMçš„å…©å€‹æ ¸å¿ƒæ§‹å¿µæ˜¯ä»€éº¼ï¼Ÿ",
        "ç­”æ¡ˆ": "å…©å€‹æ ¸å¿ƒæ§‹å¿µæ˜¯ã€Œæ„ŸçŸ¥æœ‰ç”¨æ€§ã€ï¼ˆPerceived Usefulness, PUï¼‰å’Œã€Œæ„ŸçŸ¥æ˜“ç”¨æ€§ã€ï¼ˆPerceived Ease of Use, PEOUï¼‰ã€‚",
        "keywords": ["TAM", "æ ¸å¿ƒæ§‹å¿µ", "æ„ŸçŸ¥æœ‰ç”¨æ€§", "æ„ŸçŸ¥æ˜“ç”¨æ€§", "PU", "PEOU"]
    },
    {
        "ä¸»é¡Œ": "ç§‘æŠ€æŽ¥å—æ¨¡åž‹ (TAM)",
        "å•é¡Œ": "ã€Œæ„ŸçŸ¥æœ‰ç”¨æ€§ã€æŒ‡çš„æ˜¯ä»€éº¼ï¼Ÿ",
        "ç­”æ¡ˆ": "æ„ŸçŸ¥æœ‰ç”¨æ€§æ˜¯æŒ‡ä½¿ç”¨è€…èªç‚ºä½¿ç”¨ç‰¹å®šç³»çµ±å°‡æœƒæå‡å…¶å·¥ä½œç¸¾æ•ˆçš„ç¨‹åº¦ã€‚",
        "keywords": ["æ„ŸçŸ¥æœ‰ç”¨æ€§", "å®šç¾©", "ç¸¾æ•ˆæå‡"]
    },
    {
        "ä¸»é¡Œ": "æƒ…å¢ƒå­¸ç¿’",
        "å•é¡Œ": "æƒ…å¢ƒå­¸ç¿’çš„æ ¸å¿ƒè§€é»žæ˜¯ä»€éº¼ï¼Ÿ",
        "ç­”æ¡ˆ": "æ ¸å¿ƒè§€é»žæ˜¯ã€ŒçŸ¥è­˜æ˜¯æƒ…å¢ƒåŒ–çš„ã€ï¼ˆKnowledge is situatedï¼‰å’Œã€Œå­¸ç¿’æ˜¯åƒèˆ‡æ€§çš„ã€ï¼ˆLearning is participationï¼‰ï¼Œä¸»å¼µé€šéŽå¯¦è¸å’Œç¤¾ç¾¤åƒèˆ‡é€²è¡Œå­¸ç¿’ã€‚",
        "keywords": ["æƒ…å¢ƒå­¸ç¿’", "æ ¸å¿ƒè§€é»ž", "çŸ¥è­˜æƒ…å¢ƒåŒ–", "å­¸ç¿’åƒèˆ‡æ€§"]
    },
    {
        "ä¸»é¡Œ": "æƒ…å¢ƒå­¸ç¿’",
        "å•é¡Œ": "æƒ…å¢ƒå­¸ç¿’ä¸­ã€Œåˆæ³•é‚Šç·£æ€§åƒèˆ‡ã€ï¼ˆLegitimate Peripheral Participationï¼‰æ˜¯ä»€éº¼æ„æ€ï¼Ÿ",
        "ç­”æ¡ˆ": "é€™æ˜¯æŒ‡æ–°æ‰‹é€šéŽåœ¨å¯¦è¸ç¤¾ç¾¤ï¼ˆCommunity of Practiceï¼‰ä¸­å¾žäº‹ä½Žé¢¨éšªçš„ä»»å‹™ï¼Œé€æ¼¸å¾žé‚Šç·£èµ°å‘æ ¸å¿ƒçš„åƒèˆ‡éŽç¨‹ï¼Œå¾žè€Œç²å¾—çŸ¥è­˜èˆ‡æŠ€èƒ½ã€‚",
        "keywords": ["åˆæ³•é‚Šç·£æ€§åƒèˆ‡", "LPP", "æ–°æ‰‹", "ç¤¾ç¾¤åƒèˆ‡"]
    },
    {
        "ä¸»é¡Œ": "è³‡è¨Šé ˜åŸŸå­¸ç¿’",
        "å•é¡Œ": "è³‡è¨Šç´ é¤Šï¼ˆInformation Literacyï¼‰çš„å®šç¾©æ˜¯ä»€éº¼ï¼Ÿ",
        "ç­”æ¡ˆ": "è³‡è¨Šç´ é¤Šæ˜¯æŒ‡å€‹é«”èƒ½å¤ æœ‰æ•ˆåœ°è­˜åˆ¥è³‡è¨Šéœ€æ±‚ã€å®šä½ã€è©•ä¼°ã€çµ„ç¹”å’Œå‰µé€ æ€§åœ°ä½¿ç”¨è³‡è¨Šçš„èƒ½åŠ›ã€‚",
        "keywords": ["è³‡è¨Šç´ é¤Š", "å®šç¾©", "Information Literacy", "è©•ä¼°è³‡è¨Š"]
    },
    {
        "ä¸»é¡Œ": "è³‡è¨Šé ˜åŸŸå­¸ç¿’",
        "å•é¡Œ": "ä»€éº¼æ˜¯ã€Œæ•¸ä½è½å·®ã€ï¼ˆDigital Divideï¼‰ï¼Ÿ",
        "ç­”æ¡ˆ": "æ•¸ä½è½å·®æŒ‡çš„æ˜¯ä¸åŒç¾¤é«”ä¹‹é–“åœ¨ç²å–ã€ä½¿ç”¨è³‡è¨Šå’Œé€šè¨ŠæŠ€è¡“ï¼ˆICTï¼‰çš„èƒ½åŠ›å’Œæ©Ÿæœƒä¸Šçš„å·®è·ã€‚",
        "keywords": ["æ•¸ä½è½å·®", "Digital Divide", "ICT", "å·®è·"]
    }
    // è«‹å°‡æ‚¨çš„å®Œæ•´ 20 æ¢çŸ¥è­˜é»žåŠ å…¥æ­¤è™•
];

// ----------------------------------------------------
// 2. æ ¸å¿ƒåŠŸèƒ½ï¼šçŸ¥è­˜æŸ¥è©¢ (Lookup Function)
// ----------------------------------------------------

/**
 * æ ¹æ“šè¼¸å…¥æ–‡æœ¬ï¼Œä½¿ç”¨é—œéµå­—åŒ¹é…å¾žçŸ¥è­˜åº«ä¸­æŸ¥æ‰¾æœ€ç›¸é—œçš„ç­”æ¡ˆã€‚
 * @param {string} inputText ç”¨æˆ¶è¼¸å…¥çš„æŸ¥è©¢æ–‡æœ¬ã€‚
 * @returns {string} åŒ¹é…åˆ°çš„ç­”æ¡ˆæ–‡æœ¬æˆ–é»˜èªæç¤ºã€‚
 */
function lookupKnowledge(inputText) {
    // å°‡è¼¸å…¥æ–‡æœ¬è½‰æ›ç‚ºå°å¯«ï¼Œä»¥ä¾¿é€²è¡Œä¸å€åˆ†å¤§å°å¯«çš„åŒ¹é…
    const normalizedInput = inputText.toLowerCase();
    
    // éŽæ¿¾å‡ºæ‰€æœ‰åŒ¹é…åˆ°çš„çŸ¥è­˜æ¢ç›®
    const matchingResults = KNOWLEDGE_BASE.filter(item => {
        // æª¢æŸ¥è¼¸å…¥æ–‡æœ¬æ˜¯å¦åŒ…å«è©²æ¢ç›®ä¸­çš„ä»»ä½•ä¸€å€‹é—œéµå­—
        return item.keywords.some(keyword => {
            // ä½¿ç”¨ String.prototype.includes é€²è¡Œç°¡å–®çš„å­å­—ä¸²åŒ¹é…
            return normalizedInput.includes(keyword.toLowerCase());
        });
    });
    
    // 3. çµæžœè™•ç†å’Œè¼¸å‡º
    
    if (matchingResults.length === 0) {
        // å¦‚æžœæ²’æœ‰åŒ¹é…åˆ°ä»»ä½•çµæžœ
        return "å¾ˆæŠ±æ­‰ï¼Œæˆ‘çš„çŸ¥è­˜åº«ä¸­ç›®å‰æ²’æœ‰é—œæ–¼æ­¤æŸ¥è©¢çš„ç²¾ç¢ºè³‡è¨Šã€‚";
    }
    
    if (matchingResults.length === 1) {
        // åƒ…åŒ¹é…åˆ°ä¸€å€‹çµæžœ
        const result = matchingResults[0];
        return (
            `ðŸ¤– çŸ¥è­˜æŸ¥è©¢çµæžœ (ä¸»é¡Œ: ${result.ä¸»é¡Œ}):\n` +
            `Q: ${result.å•é¡Œ}\n` +
            `A: ${result.ç­”æ¡ˆ}`
        );
    }
    
    // åŒ¹é…åˆ°å¤šå€‹çµæžœ
    const output = [
        "ðŸ¤– çŸ¥è­˜åº«åŒ¹é…åˆ°å¤šå€‹ç›¸é—œçµæžœï¼Œè«‹åƒè€ƒä»¥ä¸‹è³‡è¨Šï¼š"
    ];
    
    matchingResults.forEach((result, index) => {
        output.push(
            `---\n` +
            `çµæžœ ${index + 1} (ä¸»é¡Œ: ${result.ä¸»é¡Œ}):\n` +
            `Q: ${result.å•é¡Œ}\n` +
            `A: ${result.ç­”æ¡ˆ}`
        );
    });
    
    return output.join('\n');
}

// ----------------------------------------------------
// 4. åŸ·è¡Œç¯„ä¾‹ (Execution Example)
// ----------------------------------------------------

console.log("--- Agent çŸ¥è­˜åº«æŸ¥è©¢æ¸¬è©¦ (Node.js) ---");

/*
// æ¸¬è©¦æ¡ˆä¾‹ 1: ç²¾ç¢ºåŒ¹é…
const query1 = "è«‹å• TAM çš„å…©å€‹æ ¸å¿ƒæ§‹å¿µæ˜¯ä»€éº¼ï¼Ÿ";
console.log(`\n> æŸ¥è©¢ 1: ${query1}`);
const response1 = lookupKnowledge(query1);
console.log(response1);

// æ¸¬è©¦æ¡ˆä¾‹ 2: åŒ…å«é—œéµå­—ï¼Œä½†ä¸æ˜¯ç²¾ç¢ºå•é¡Œ
const query2 = "æˆ‘æƒ³çŸ¥é“ä»€éº¼æ˜¯ Generative AI";
console.log(`\n> æŸ¥è©¢ 2: ${query2}`);
const response2 = lookupKnowledge(query2);
console.log(response2);

// æ¸¬è©¦æ¡ˆä¾‹ 3: åŒ¹é…ä¸åˆ°çµæžœ
const query3 = "é—œæ–¼æ°¸çºŒç™¼å±•ç›®æ¨™æœ‰æ²’æœ‰è³‡è¨Šï¼Ÿ";
console.log(`\n> æŸ¥è©¢ 3: ${query3}`);
const response3 = lookupKnowledge(query3);
console.log(response3);

// æ¸¬è©¦æ¡ˆä¾‹ 4: æ¨¡ç³Šæˆ–å¤šé‡åŒ¹é… (ä¾‹å¦‚åŒæ™‚åŒ…å« TAM å’Œ æ„ŸçŸ¥æœ‰ç”¨æ€§)
const query4 = "æˆ‘æƒ³æŸ¥æŸ¥ TAM æ¨¡åž‹çš„ æ„ŸçŸ¥æœ‰ç”¨æ€§ æ˜¯ä»€éº¼ï¼Ÿ";
console.log(`\n> æŸ¥è©¢ 4: ${query4}`);
const response4 = lookupKnowledge(query4);
console.log(response4);
*/

// å°Žå‡ºå‡½æ•¸ä»¥ä¾› server.js ä½¿ç”¨
module.exports = { lookupKnowledge };